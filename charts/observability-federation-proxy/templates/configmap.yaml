apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "observability-federation-proxy.fullname" . }}
  labels:
    {{- include "observability-federation-proxy.labels" . | nindent 4 }}
data:
  config.yaml: |
    proxy:
      listenAddress: {{ .Values.proxy.listenAddress | quote }}
      queryTimeout: {{ .Values.proxy.queryTimeout | quote }}
      maxTenantHeaderLength: {{ .Values.proxy.maxTenantHeaderLength }}
      metricsEnabled: {{ .Values.proxy.metricsEnabled }}

    auth:
      enabled: {{ .Values.auth.enabled }}
      # Bearer tokens are loaded from AUTH_BEARER_TOKENS environment variable

    logging:
      level: {{ .Values.logging.level | quote }}
      format: {{ .Values.logging.format | quote }}

    {{- if .Values.clusters }}
    clusters:
      {{- toYaml .Values.clusters | nindent 6 }}
    {{- else }}
    clusters: []
    {{- end }}
