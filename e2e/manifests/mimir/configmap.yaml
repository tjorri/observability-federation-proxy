apiVersion: v1
kind: ConfigMap
metadata:
  name: mimir-config
  namespace: observability
  labels:
    app: mimir
data:
  mimir.yaml: |
    multitenancy_enabled: true

    tenant_federation:
      enabled: true

    server:
      http_listen_port: 8080
      grpc_listen_port: 9095
      log_level: info

    common:
      storage:
        backend: filesystem
        filesystem:
          dir: /data/mimir

    blocks_storage:
      backend: filesystem
      filesystem:
        dir: /data/mimir/blocks
      bucket_store:
        sync_dir: /data/mimir/tsdb-sync

    compactor:
      data_dir: /data/mimir/compactor
      sharding_ring:
        kvstore:
          store: inmemory

    distributor:
      ring:
        kvstore:
          store: inmemory

    ingester:
      ring:
        kvstore:
          store: inmemory
        replication_factor: 1

    store_gateway:
      sharding_ring:
        kvstore:
          store: inmemory

    ruler_storage:
      backend: filesystem
      filesystem:
        dir: /data/mimir/rules

    limits:
      max_global_series_per_user: 0
      max_global_series_per_metric: 0
      ingestion_rate: 100000
      ingestion_burst_size: 1000000

    activity_tracker:
      filepath: /data/mimir/activity.log
